@startuml
actor Admin
participant "Login.vue" as Login
participant "Router" as Router
participant "useAuthStore (Pinia)" as Store
participant "AdminSelect.vue" as AdminSelect
participant "RekapitulasiUser.vue" as UserPage
participant "Database.vue" as DataPage

title Admin Role Sequence Diagram (Component Level)

== Authentication Flow ==
Admin -> Login: Masukkan Username & Password
activate Login
Login -> Login: Validasi Input
Login -> Store: loginWithCredentials(username, password)
activate Store
Store -> Store: api.login()
Store -> Store: setUser(data)
Store --> Login: Login Berhasil (Role: admin)
deactivate Store

Login -> Router: router.push('/admin-select')
activate Router
Router -> AdminSelect: Tampilkan AdminSelect.vue
deactivate Router
deactivate Login
activate AdminSelect
Admin -> AdminSelect: Lihat Pilihan Mode
deactivate AdminSelect

== User Management Flow ==
Admin -> AdminSelect: Klik "Manajemen Pengguna"
activate AdminSelect
AdminSelect -> Router: router.push('/rekapitulasi-user')
deactivate AdminSelect
activate Router
Router -> UserPage: Tampilkan RekapitulasiUser.vue
deactivate Router
activate UserPage

UserPage -> UserPage: onMounted() -> api.getUsers()
UserPage --> Admin: Tampilkan Tabel User

group Edit User
    Admin -> UserPage: Klik "Edit" pada Row
    UserPage -> UserPage: Buka Modal Edit
    Admin -> UserPage: Ubah Data & Klik Simpan
    UserPage -> UserPage: api.updateUser()
    UserPage -> UserPage: Refresh Data
    UserPage --> Admin: Update Tabel
end

group Voice Sample & MFCC
    Admin -> UserPage: Klik "Play Audio"
    UserPage -> UserPage: Play Audio Blob from Backend

    Admin -> UserPage: Klik "User MFCC"
    UserPage -> UserPage: Download CSV (api.exportUserMfcc)
end
deactivate UserPage

== Data Management Flow (Database) ==
Admin -> Router: (Navigasi Balik / Menu)
Router -> AdminSelect: Tampilkan AdminSelect.vue
activate AdminSelect

Admin -> AdminSelect: Klik "Manajemen Data"
AdminSelect -> Router: router.push('/database')
deactivate AdminSelect
activate Router
Router -> DataPage: Tampilkan Database.vue
deactivate Router
activate DataPage

DataPage -> DataPage: onMounted() -> api.getInterviews()
DataPage --> Admin: Tampilkan Tabel Data Wawancara

group Play Recording
    Admin -> DataPage: Klik "Play" Icon
    DataPage -> DataPage: Fetch Audio (api.getInterviewAudio)
    DataPage --> Admin: Audio Playback
end

group Edit Interview
    Admin -> DataPage: Klik "Edit"
    DataPage -> Router: router.push('/interview?edit=id')
    Router -> DataPage: (Redirects to Editor)
    DataPage --> Admin: Form Edit Wawancara
end

group Export MFCC
    Admin -> DataPage: Klik "Intv MFCC"
    DataPage -> DataPage: Download CSV (api.exportInterviewMfcc)
end

deactivate DataPage

== Logout Flow ==
Admin -> UserPage: Klik "Logout" (Generic Navbar)
UserPage -> Store: logout()
activate Store
Store -> Store: Clear State & LocalStorage
deactivate Store
UserPage -> Router: router.push('/')
Router -> Login: Tampilkan Login.vue

@enduml
